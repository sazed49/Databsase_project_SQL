
DROP TABLE DISTRIBUTOR_TABLE;
DROP TABLE VACCINE_TABLE;

DROP TABLE MEDICAL_INFO;
DROP TABLE DISTRIBUTIONS;
--DROP TABLE MEDICAL_INFO;
/*TABLE CREATE VACCCINE_TABLE*/
CREATE TABLE VACCINE_TABLE(
	VAC_ID INT PRIMARY KEY,
	MANUFACTURER VARCHAR(20),
	type VARCHAR(20)
);

/*Adding another column*/

ALTER TABLE VACCINE_TABLE ADD country VARCHAR(20);

--DESCRIBE VACCCINE_TABLE;
--DISTRIBUTOR_TABLE CREATE

CREATE TABLE DISTRIBUTOR_TABLE(
	VAC_ID INT,
	COMP_NAME VARCHAR(20),
	COMP_ID INT,
	AREA_ZIP_CODE INT PRIMARY KEY,
	FOREIGN KEY (VAC_ID) REFERENCES VACCINE_TABLE(VAC_ID) ON DELETE SET NULL
);

-- ALTER TABLE DISTRIBUTOR_TABLE
-- RENAME COLUMN BATCH_ID TO VAC_ID;
--DESCRIBE DISTRIBUTOR_TABLE;

-- PEOPLE TABLE CREATED
CREATE TABLE PEOPLE(
	NATIONAL_ID INT PRIMARY KEY,
	NAME VARCHAR(20),
	AGE INT,
	PROFESSION VARCHAR(20),
	FREEDOMFIGHTER VARCHAR(20),
	AREA_ZIP_CODE INT,
	FOREIGN KEY (AREA_ZIP_CODE) REFERENCES DISTRIBUTOR_TABLE ON DELETE SET NULL
);
--DESCRIBE PEOPLE;
--COM_MANU TABLE CREATE
CREATE TABLE COM_MANU(
	COMP_NAME VARCHAR(20),
	NANUFACTURER VARCHAR(20)
);
--DESCRIBE COMP_MANU;
-- CREATE TABLE  MEDICAL INFO
CREATE TABLE MEDICAL_INFO(
	NATIONAL_ID INT,
	NAME VARCHAR(20),
	AGE INT,
	GENDER VARCHAR(10),
	PREVIOUS_DIFFICULTIES VARCHAR(20),
	POSSIBLE_DATE DATE,
	AREA_ZIP_CODE INT,
	FOREIGN KEY (AREA_ZIP_CODE) REFERENCES DISTRIBUTOR_TABLE ON DELETE SET NULL,
	FOREIGN KEY (NATIONAL_ID) REFERENCES PEOPLE ON DELETE SET NULL
);

DESCRIBE MEDICAL_INFO;

-- --DISTRIBUTIONS TABLE CREATE
CREATE TABLE DISTRIBUTIONS(
	AREA_ZIP_CODE INT,
	COMP_ID INT,
	POPULATION INT,
	HOSPITAL VARCHAR(20),
	POSSIBLE_DATE DATE,
	FOREIGN KEY (AREA_ZIP_CODE) REFERENCES DISTRIBUTOR_TABLE(AREA_ZIP_CODE)ON DELETE SET NULL
);

DESCRIBE DISTRIBUTIONS;
-- --INSERT INTO VACCINE_TABLE
INSERT INTO VACCINE_TABLE VALUES (1, 'Pfizer', 'Whole Virus', 'USA');
INSERT INTO VACCINE_TABLE VALUES (2, 'Sinopharm', 'Protein Submit', 'Beijing');
INSERT INTO VACCINE_TABLE VALUES (3, 'Astrazenca', 'Nucleic Acid', 'Oxford');
INSERT INTO  VACCINE_TABLE VALUES (4, 'JohnsonAndJohnson', 'Viral Vector', 'Europe');
INSERT INTO VACCINE_TABLE VALUES (5, 'abc', 'viral', 'bd');





 SELECT * FROM VACCINE_TABLE;
-- --INSERT INTO DISTRIBUTOR_TABLE
INSERT INTO DISTRIBUTOR_TABLE VALUES (1, 'Beximco', '512', '1205');
INSERT INTO DISTRIBUTOR_TABLE VALUES (2, 'Drug International', '513', '1206');
INSERT INTO DISTRIBUTOR_TABLE VALUES (3, 'Ambee', '514', '1207');

INSERT INTO DISTRIBUTOR_TABLE VALUES (3, 'Dhaka Pharmacy', '517', '1210');
INSERT INTO DISTRIBUTOR_TABLE VALUES (1, 'IBN SINA', '518', '1211');	
INSERT INTO DISTRIBUTOR_TABLE VALUES (2, 'Businesspoint', '516', '1209');
INSERT INTO DISTRIBUTOR_TABLE VALUES (4, 'Square', '515', '1208');



 SELECT * FROM DISTRIBUTOR_TABLE;

 




-- -- -- INSERTION INTO PEOPLE

INSERT INTO PEOPLE VALUES (1027, 'Bashar', '55', 'Worker', 'Y', 1206);
INSERT INTO PEOPLE VALUES (1028, 'Ibrahim', '20', 'Student', 'N', 1210);
INSERT INTO PEOPLE VALUES (1029, 'Khalil', '60', 'Govt. Service', 'Y', 1208);
INSERT INTO PEOPLE VALUES (1031, 'Naima', '65', 'Retd', 'Y', 1211);
INSERT INTO PEOPLE VALUES (1024, 'Rahim', '30', 'Doctor', 'N', 1211);
INSERT INTO PEOPLE VALUES (1025, 'Sultan', '45', 'Govt. Service', 'Y', 1211);
INSERT INTO PEOPLE VALUES (1026, 'Fatema', '18', 'Student', 'N', 1211);

SELECT * FROM PEOPLE;


-- --NATURAL JOIN
SELECT VACCINE_TABLE.MANUFACTURER,DISTRIBUTOR_TABLE.COMP_NAME
  FROM VACCINE_TABLE NATURAL JOIN DISTRIBUTOR_TABLE;

-- -- -- -- /*Which Company will distribute which manufacturer's vaccine(Inner Join)*/
 SELECT DISTRIBUTOR_TABLE.COMP_NAME,DISTRIBUTOR_TABLE.COMP_ID,VACCINE_TABLE.MANUFACTURER
 FROM DISTRIBUTOR_TABLE  JOIN VACCINE_TABLE
 ON DISTRIBUTOR_TABLE.VAC_ID=VACCINE_TABLE.VAC_ID;

-- -- --  /*Which Company will distribute which manufacturer's vaccine(RIGHT Join)*/
  SELECT DISTRIBUTOR_TABLE.COMP_NAME,DISTRIBUTOR_TABLE.COMP_ID,VACCINE_TABLE.MANUFACTURER
  FROM DISTRIBUTOR_TABLE  RIGHT JOIN VACCINE_TABLE
  ON DISTRIBUTOR_TABLE.VAC_ID=VACCINE_TABLE.VAC_ID;
--   --FULL OUTER JOIN
  SELECT DISTRIBUTOR_TABLE.COMP_NAME,DISTRIBUTOR_TABLE.COMP_ID,VACCINE_TABLE.MANUFACTURER
  FROM DISTRIBUTOR_TABLE  FULL OUTER JOIN VACCINE_TABLE
  ON DISTRIBUTOR_TABLE.VAC_ID=VACCINE_TABLE.VAC_ID;

 DESCRIBE DISTRIBUTOR_TABLE;
INSERT INTO MEDICAL_INFO VALUES(1027,'BASHAR',55,'M','DIABETES',to_DATE('2021-05-10','YYYY-MM-DD'),1206);
INSERT INTO MEDICAL_INFO VALUES(1029,'KHALIL',60,'M','DIABETES',to_DATE('2021-05-11','YYYY-MM-DD'),1208);
INSERT INTO MEDICAL_INFO VALUES(1031,'NAIMA',65,'F','DIABETES',to_DATE('2021-05-12','YYYY-MM-DD'),1211);
INSERT INTO MEDICAL_INFO VALUES(1026,'FATEMA',18,'F','HEALTHY',to_DATE('2021-05-13','YYYY-MM-DD'),1207);
 INSERT INTO MEDICAL_INFO VALUES(1024,'RAHIM',30,'M','STRESS',to_DATE('2021-05-14','YYYY-MM-DD'),1205);
INSERT INTO MEDICAL_INFO VALUES(1025,'SULTAN',45,'M','HEALTHY',to_DATE('2021-05-14','YYYY-MM-DD'),1209);
INSERT INTO MEDICAL_INFO VALUES(1028,'IBRAHIM',20,'M','HEALTHY',to_DATE('2021-05-11','YYYY-MM-DD'),1210);
SELECT * FROM MEDICAL_INFO;

INSERT INTO DISTRIBUTIONS VALUES(1205,512,10000,'SADAR',to_DATE('2021-05-14', 'YYYY-MM-DD'));
INSERT INTO DISTRIBUTIONS VALUES (1208 , 515 , 100000, 'Ali Azgar', to_DATE('2021-05-11', 'YYYY-MM-DD'));
INSERT INTO DISTRIBUTIONS VALUES (1211 , 517 , 8000, 'SADAR', to_DATE('2021-05-12', 'YYYY-MM-DD'));
INSERT INTO DISTRIBUTIONS VALUES (1207 , 514 , 2000, 'tipu sultan', to_DATE('2021-05-13', 'YYYY-MM-DD'));
INSERT INTO DISTRIBUTIONS VALUES (1206 , 513 , 15000, 'tipu sultan', to_DATE('2021-05-10', 'YYYY-MM-DD'));
INSERT INTO DISTRIBUTIONS VALUES (1205 , 512 , 1500, 'Ali Azgar', to_DATE('2021-05-14', 'YYYY-MM-DD'));
INSERT INTO DISTRIBUTIONS VALUES (1208 , 515 , 2500, 'IBN SINA', to_DATE('2021-05-11', 'YYYY-MM-DD'));

SELECT * FROM DISTRIBUTIONS;
-- FIND ELIGIBLE PEOPLE FROM PEOPLE TABLE
SELECT * FROM PEOPLE WHERE AGE>40 OR FREEDOMFIGHTER='Y';

-- FIND NO OF DIABETIC PATIENT FROM MEDICAL_INFO TABLE

SELECT COUNT(NATIONAL_ID)
FROM MEDICAL_INFO
WHERE PREVIOUS_DIFFICULTIES='DIABETES';

-- FIND NO OF POPULATION OF PLACES FROM WHERE HEALTHY PEOPLE ARE FROM
SELECT DIS.POPULATION,DIS.HOSPITAL
FROM DISTRIBUTIONS DIS
WHERE DIS.AREA_ZIP_CODE IN(
	SELECT MEDI.AREA_ZIP_CODE
	FROM MEDICAL_INFO MEDI
	WHERE MEDI.PREVIOUS_DIFFICULTIES='HEALTHY'
);